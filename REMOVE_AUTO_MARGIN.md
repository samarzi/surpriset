# Удаление автоматической наценки 20%

## Дата: 26 января 2026

## Изменения
Убрана автоматическая наценка 20% при импорте товаров с маркетплейсов (Ozon, Wildberries, Яндекс Маркет).

## Что изменено

### 1. ProductForm.tsx
**Наценка по умолчанию изменена с 20% на 0%:**

```typescript
// БЫЛО
margin_percent: 20 // Наценка по умолчанию 20%

// СТАЛО
margin_percent: 0 // Наценка по умолчанию 0% (без наценки)
```

**Изменения в 4 местах:**
1. Начальное состояние формы
2. При загрузке существующего товара
3. При импорте с маркетплейса
4. В placeholder поля ввода

**Обновлено сообщение об успешном импорте:**
```
✅ Товар успешно загружен с Ozon!

Цена импортирована: 1329₽

Цена импортирована БЕЗ наценки. Вы можете добавить наценку перед сохранением товара.
```

### 2. priceUpdateService.ts
**Наценка по умолчанию при обновлении цен:**

```typescript
// БЫЛО
const marginPercent = product.margin_percent ?? 20;

// СТАЛО
const marginPercent = product.margin_percent ?? 0;
```

## Как это работает

### При импорте товара:
1. Цена импортируется **БЕЗ наценки** (как есть с маркетплейса)
2. Поле "Наценка (%)" по умолчанию = **0%**
3. Админ может вручную установить любую наценку от 0% до 100%
4. Наценка применяется **только при сохранении** товара

### Пример:
- Цена на Ozon: **1329₽**
- Импортированная цена: **1329₽** (без наценки)
- Админ устанавливает наценку: **15%**
- Итоговая цена при сохранении: **1329 × 1.15 = 1528₽**

### При автоматическом обновлении цен:
- Если у товара не указана наценка → используется **0%** (цена как на маркетплейсе)
- Если у товара указана наценка → используется **сохраненная наценка**

## Преимущества

✅ **Прозрачность** - цены импортируются без скрытых наценок
✅ **Гибкость** - админ сам решает, какую наценку применить
✅ **Контроль** - наценка видна и редактируется перед сохранением
✅ **Честность** - можно продавать по ценам маркетплейса (0% наценка)

## Файлы изменены
- `src/components/admin/ProductForm.tsx` - 5 изменений
- `src/lib/priceUpdateService.ts` - 1 изменение

## Тестирование
1. Импортируйте товар с Ozon
2. Проверьте, что цена импортирована без наценки
3. Проверьте, что поле "Наценка (%)" = 0
4. Установите наценку (например, 15%)
5. Сохраните товар
6. Проверьте, что итоговая цена = импортированная цена × (1 + наценка/100)

## Статус
✅ **ГОТОВО** - Автоматическая наценка 20% удалена, по умолчанию используется 0%.
