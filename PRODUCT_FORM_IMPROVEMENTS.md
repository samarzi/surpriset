# Улучшения формы товара

## Дата: 26 января 2026

## Изменения

### 1. Возвращена наценка 20% по умолчанию
- Наценка по умолчанию снова 20% (было временно изменено на 0%)
- Применяется при импорте товаров с маркетплейсов
- Placeholder в поле наценки: "20"

### 2. Убраны кнопки листания (spinner) в поле наценки
Добавлены CSS классы для скрытия стрелок вверх/вниз:
```tsx
className="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
```

Теперь поле наценки выглядит чище без кнопок листания.

### 3. Автоматическое заполнение первоначальной цены при импорте
**Проблема:** При импорте товара первоначальная цена не заполнялась автоматически, пока не зайдешь и не выйдешь из поля "Цена".

**Решение:** Теперь первоначальная цена рассчитывается сразу при импорте:
```typescript
// Автоматически рассчитываем первоначальную цену с наценкой 15-30%
let calculatedOriginalPrice = '';
if (basePrice > 0 && !baseOriginalPrice) {
  const randomPercent = 15 + Math.random() * 15; // 15-30%
  calculatedOriginalPrice = Math.round(basePrice * (1 + randomPercent / 100)).toString();
}

// Заполняем форму
setFormData(prev => ({
  ...prev,
  original_price: baseOriginalPrice ? baseOriginalPrice.toString() : calculatedOriginalPrice,
  // ...
}));
```

**Логика:**
- Если маркетплейс предоставил старую цену → используем её
- Если нет → автоматически добавляем 15-30% к текущей цене

### 4. SKU генерируется как 6-значное число
**Было:** `IMP-${Date.now()}` (например, `IMP-1738012345678`)

**Стало:** 6-значное случайное число (например, `456789`)

```typescript
// Генерируем SKU как 6-значное число
const sku = formData.sku || Math.floor(100000 + Math.random() * 900000).toString();
```

**Диапазон:** от 100000 до 999999

## Примеры

### Импорт товара с Ozon:
1. **Цена на Ozon:** 1329₽
2. **Импортированная цена:** 1329₽
3. **Первоначальная цена:** автоматически ~1528₽ (1329 + 15%)
4. **SKU:** 456789 (случайное 6-значное число)
5. **Наценка:** 20% (по умолчанию)
6. **Итоговая цена при сохранении:** 1329 × 1.20 = 1595₽

### Импорт товара с Wildberries (со старой ценой):
1. **Цена на WB:** 2500₽
2. **Старая цена на WB:** 3200₽
3. **Импортированная цена:** 2500₽
4. **Первоначальная цена:** 3200₽ (из маркетплейса)
5. **SKU:** 789123 (случайное 6-значное число)
6. **Наценка:** 20% (по умолчанию)
7. **Итоговая цена при сохранении:** 2500 × 1.20 = 3000₽

## Файлы изменены
- `src/components/admin/ProductForm.tsx` - 6 изменений
- `src/lib/priceUpdateService.ts` - 1 изменение

## Статус
✅ **ГОТОВО** - Все 3 улучшения реализованы:
1. ✅ Наценка 20% по умолчанию
2. ✅ Убраны кнопки листания в поле наценки
3. ✅ Первоначальная цена заполняется автоматически при импорте
4. ✅ SKU генерируется как 6-значное число
