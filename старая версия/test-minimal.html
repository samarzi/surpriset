<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç React</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .log { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h1>
        
        <div id="status" class="status info">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</div>
        
        <button onclick="testReactApp()">üöÄ –¢–µ—Å—Ç React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</button>
        <button onclick="clearLog()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        
        <div class="log" id="log"><strong>–õ–æ–≥:</strong><br></div>
        
        <div id="test-container" style="border: 1px solid #ddd; padding: 20px; margin: 20px 0; min-height: 200px;">
            <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç...</p>
        </div>
    </div>

    <script type="module">
        function log(message, type = 'info') {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è';
            logElement.innerHTML += `<div>[${timestamp}] ${prefix} ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function updateStatus(message, type = 'info') {
            const statusElement = document.getElementById('status');
            statusElement.className = `status ${type}`;
            statusElement.textContent = message;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '<strong>–õ–æ–≥:</strong><br>';
        }

        window.testReactApp = async function() {
            log('–ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            updateStatus('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...', 'info');
            
            try {
                // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
                log('1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...');
                const response = await fetch('http://localhost:3000');
                
                if (!response.ok) {
                    throw new Error(`–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${response.status}`);
                }
                log('‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω', 'success');
                
                // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
                log('2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π React...');
                
                try {
                    const reactModule = await import('http://localhost:3000/@fs/Users/samarzi/Desktop/IT/D%20E%20M%20O/surpriset-unified/node_modules/react/index.js');
                    log('‚úÖ React –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
                } catch (error) {
                    log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ React: ${error.message}`, 'error');
                }
                
                // 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                log('3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è...');
                
                try {
                    const mainModule = await import('http://localhost:3000/src/main.tsx');
                    log('‚úÖ –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
                } catch (error) {
                    log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è: ${error.message}`, 'error');
                    throw error;
                }
                
                // 4. –°–æ–∑–¥–∞–µ–º iframe –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
                log('4. –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞...');
                
                const iframe = document.createElement('iframe');
                iframe.style.width = '100%';
                iframe.style.height = '400px';
                iframe.style.border = '1px solid #ddd';
                iframe.src = 'http://localhost:3000';
                
                const container = document.getElementById('test-container');
                container.innerHTML = '';
                container.appendChild(iframe);
                
                // 5. –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏
                await new Promise((resolve, reject) => {
                    const timeout = setTimeout(() => {
                        reject(new Error('–¢–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è'));
                    }, 10000);
                    
                    iframe.onload = () => {
                        clearTimeout(timeout);
                        log('‚úÖ Iframe –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
                        resolve();
                    };
                    
                    iframe.onerror = (error) => {
                        clearTimeout(timeout);
                        reject(new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ iframe'));
                    };
                });
                
                // 6. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É
                setTimeout(() => {
                    try {
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        if (iframeDoc) {
                            const rootElement = iframeDoc.getElementById('root');
                            if (rootElement && rootElement.children.length > 0) {
                                log('‚úÖ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ', 'success');
                                updateStatus('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!', 'success');
                            } else {
                                log('‚ùå React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–æ—Å—å', 'error');
                                updateStatus('‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π React', 'error');
                            }
                        } else {
                            log('‚ö†Ô∏è –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É iframe (CORS)', 'warning');
                            updateStatus('‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø', 'warning');
                        }
                    } catch (error) {
                        log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ: ${error.message}`, 'warning');
                    }
                }, 3000);
                
            } catch (error) {
                log(`‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`, 'error');
                updateStatus('‚ùå –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω', 'error');
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
                log('–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:', 'info');
                log('- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: npm run dev', 'info');
                log('- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏', 'info');
                log('- –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000 –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ', 'info');
            }
        };

        window.clearLog = clearLog;
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
        setTimeout(() => {
            log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞...');
            window.testReactApp();
        }, 1000);
    </script>
</body>
</html>