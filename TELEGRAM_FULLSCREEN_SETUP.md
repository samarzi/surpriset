# Настройка полноэкранного режима Telegram WebApp

## Описание

Данная реализация настраивает Telegram WebApp для работы в полноэкранном режиме с отключением свайпа для закрытия приложения. Теперь приложение можно закрыть только через кнопку закрытия в интерфейсе Telegram.

## Что было изменено

### 1. Обновлен `src/utils/telegram.ts`

- Добавлена функция `enableFullscreenMode()` для активации полноэкранного режима
- Расширен интерфейс `TelegramWebApp` с поддержкой новых API методов
- Улучшена функция `initTelegramWebApp()` для автоматической настройки полноэкранного режима
- Добавлена обработка событий viewport и закрытия приложения

### 2. Обновлен `src/hooks/useTelegramWebApp.ts`

- Добавлено отслеживание состояния полноэкранного режима (`isFullscreen`)
- Добавлена функция `forceFullscreen()` для принудительного включения полноэкранного режима
- Улучшена логика проверки статуса приложения

### 3. Обновлен `src/App.tsx`

- Добавлена автоматическая активация полноэкранного режима при загрузке
- Интегрирована проверка статуса полноэкранного режима

### 4. Обновлен `src/index.css`

- Добавлены стили для класса `.telegram-fullscreen`
- Улучшены стили для предотвращения случайного закрытия свайпом
- Добавлена поддержка `overscroll-behavior: none` для отключения pull-to-refresh

## Ключевые особенности

### Полноэкранный режим
- Приложение автоматически разворачивается на весь экран при запуске
- Используется `tg.expand()` и новый API `tg.requestFullscreen()` (если доступен)
- Приложение занимает всю доступную область viewport

### Отключение свайпа для закрытия
- Включается `tg.enableClosingConfirmation()` для отключения свайпа
- Добавлены CSS правила `overscroll-behavior: none` для предотвращения жестов
- Приложение можно закрыть только через кнопку в интерфейсе Telegram

### Адаптивность
- Автоматическое обновление размеров при изменении viewport
- Поддержка CSS переменной `--tg-viewport-height`
- Корректная работа на разных устройствах и версиях Telegram

## Как это работает

1. **Инициализация**: При загрузке приложения вызывается `initTelegramWebApp()`
2. **Активация полноэкранного режима**: Вызывается `enableFullscreenMode()`
3. **Отключение свайпа**: Включается подтверждение закрытия через `enableClosingConfirmation()`
4. **Мониторинг**: Отслеживаются изменения viewport и статуса приложения
5. **Повторные попытки**: Выполняются дополнительные попытки активации с задержками

## Совместимость

- Работает с различными версиями Telegram (iOS, Android, Desktop)
- Поддерживает как старые, так и новые API методы Telegram WebApp
- Graceful degradation для неподдерживаемых функций

## Отладка

Для отладки в консоли браузера будут выводиться сообщения:
- `Telegram WebApp detected in React hook!`
- `Enabling fullscreen mode...`
- `Fullscreen mode requested via new API`
- `Closing confirmation enabled (disables swipe-to-close)`
- `WebApp expanded status: true`
- `WebApp fullscreen status: true`

## Проверка работы

1. Откройте приложение в Telegram
2. Убедитесь, что приложение открывается в полноэкранном режиме
3. Попробуйте свайп вниз - приложение не должно закрываться
4. Используйте кнопку закрытия в интерфейсе Telegram для выхода

## Дополнительные настройки

При необходимости можно вызвать `forceFullscreen()` из хука `useTelegramWebApp` для принудительной активации полноэкранного режима в любой момент.